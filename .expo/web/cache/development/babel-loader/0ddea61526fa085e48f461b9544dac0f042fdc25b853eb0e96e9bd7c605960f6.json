{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/yavuzceliker/Desktop/projects/yavuz/react/qr4car/mobile/app/root.js\",\n  _this = this;\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useEffect, useState } from \"react\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { useGetApi, useI18n } from \"./infrastructure/api-calls/api-call\";\nimport general from \"./utils/general\";\nimport Navigation from \"./navigation\";\nimport AppRoutes from \"./utils/app-routes\";\nimport AlertRenderer from \"./components/alert-renderer/alertRenderer\";\nimport i18next from \"i18next\";\nimport useRefState from \"./utils/hooks/use-ref-state\";\nimport FullScreenLoading from \"./components/loading/full-screen-loading\";\nimport CommandBus from \"./infrastructure/command-bus/command-bus\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions as AuthActions } from \"./infrastructure/redux/auth/reducers\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar Root = function Root() {\n  var dispatch = useDispatch();\n  var _useRefState = useRefState(\"en\"),\n    _useRefState2 = _slicedToArray(_useRefState, 3),\n    currentLanguage = _useRefState2[0],\n    currentLanguageRef = _useRefState2[1],\n    setCurrentLanguage = _useRefState2[2];\n  var _useRefState3 = useRefState({\n      userInfoLoaded: false\n    }),\n    _useRefState4 = _slicedToArray(_useRefState3, 3),\n    formProps = _useRefState4[0],\n    formPropsRef = _useRefState4[1],\n    setFormProps = _useRefState4[2];\n  var fetchUserInfo = useGetApi({\n    controller: \"user\",\n    action: \"userInfo\",\n    enabled: false\n  });\n  var _useI18n = useI18n(currentLanguage),\n    translates = _useI18n.data,\n    translateIsFetched = _useI18n.isFetched;\n  useEffect(function () {\n    if (translateIsFetched && translates) {\n      i18next.init({\n        compatibilityJSON: 'v3',\n        lng: currentLanguageRef.current,\n        resources: _defineProperty({}, currentLanguageRef.current, {\n          translation: translates\n        })\n      });\n    }\n  }, [translates, translateIsFetched]);\n  useEffect(function () {\n    if (translateIsFetched && translates) _asyncToGenerator(function* () {\n      var result = yield fetchUserInfo.refetch();\n      if (result.isSuccess) {\n        if (result.data.success) {\n          dispatch(AuthActions.logIn(_objectSpread(_objectSpread({}, result.data.data), {}, {\n            token: yield AsyncStorage.getItem(\"token\")\n          })));\n        } else {\n          console.log(\"err\", result.data);\n        }\n        setTimeout(function () {\n          setFormProps({\n            userInfoLoaded: true\n          });\n        }, 100);\n      }\n    })();\n  }, [translateIsFetched]);\n  console.log(\"translateIsFetched\", formPropsRef.userInfoLoaded);\n  if (translateIsFetched && translates && formProps.userInfoLoaded) return _jsxDEV(_Fragment, {\n    children: [_jsxDEV(StatusBar, {\n      hidden: false,\n      backgroundColor: \"#fff\",\n      barStyle: \"dark-content\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 17\n    }, _this), _jsxDEV(Navigation, {\n      initialRoute: AppRoutes.Auth.initialRoute\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }, _this), _jsxDEV(AlertRenderer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }, _this), _jsxDEV(FullScreenLoading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }, _this)]\n  }, void 0, true);\n  return null;\n};\nexport default Root;","map":{"version":3,"names":["React","useEffect","useState","StatusBar","Text","View","useGetApi","useI18n","general","Navigation","AppRoutes","AlertRenderer","i18next","useRefState","FullScreenLoading","CommandBus","useDispatch","Actions","AuthActions","AsyncStorage","jsxDEV","_jsxDEV","Fragment","_Fragment","Root","dispatch","_useRefState","_useRefState2","_slicedToArray","currentLanguage","currentLanguageRef","setCurrentLanguage","_useRefState3","userInfoLoaded","_useRefState4","formProps","formPropsRef","setFormProps","fetchUserInfo","controller","action","enabled","_useI18n","translates","data","translateIsFetched","isFetched","init","compatibilityJSON","lng","current","resources","_defineProperty","translation","_asyncToGenerator","result","refetch","isSuccess","success","logIn","_objectSpread","token","getItem","console","log","setTimeout","children","hidden","backgroundColor","barStyle","fileName","_jsxFileName","lineNumber","columnNumber","_this","initialRoute","Auth"],"sources":["/Users/yavuzceliker/Desktop/projects/yavuz/react/qr4car/mobile/app/root.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { StatusBar, Text, View } from \"react-native\"\nimport { useGetApi, useI18n } from \"./infrastructure/api-calls/api-call\"\nimport general from \"./utils/general\";\nimport Navigation from \"./navigation\";\nimport AppRoutes from \"./utils/app-routes\";\nimport AlertRenderer from \"./components/alert-renderer/alertRenderer\";\nimport i18next from \"i18next\";\nimport useRefState from \"./utils/hooks/use-ref-state\";\nimport FullScreenLoading from \"./components/loading/full-screen-loading\";\nimport CommandBus from \"./infrastructure/command-bus/command-bus\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions as AuthActions } from \"./infrastructure/redux/auth/reducers\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst Root = () => {\n    const dispatch = useDispatch();\n    const [currentLanguage, currentLanguageRef, setCurrentLanguage] = useRefState(\"en\")\n    const [formProps, formPropsRef, setFormProps] = useRefState({\n        userInfoLoaded: false,\n    });\n    const fetchUserInfo = useGetApi({ controller: \"user\", action: \"userInfo\", enabled: false })\n    const { data: translates, isFetched: translateIsFetched } = useI18n(currentLanguage);\n\n    useEffect(() => {\n        if (translateIsFetched && translates) {\n            i18next.init({\n                compatibilityJSON: 'v3',\n                lng: currentLanguageRef.current,\n                resources: {\n                    [currentLanguageRef.current]: {\n                        translation: translates\n                    }\n                }\n            });\n        }\n    }, [translates, translateIsFetched])\n\n    useEffect(() => {\n        if (translateIsFetched && translates)\n            (async () => {\n                var result = await fetchUserInfo.refetch();\n                if (result.isSuccess) {\n                    if (result.data.success) {\n                        dispatch(AuthActions.logIn({\n                            ...result.data.data,\n                            token: await AsyncStorage.getItem(\"token\")\n                        }))\n                    }\n                    else {\n                        console.log(\"err\", result.data)\n                    }\n                    setTimeout(() => {\n                        setFormProps({ userInfoLoaded: true })\n                    }, 100);\n                }\n            })();\n    }, [translateIsFetched])\n\n    console.log(\"translateIsFetched\", formPropsRef.userInfoLoaded)\n\n    if (translateIsFetched && translates && formProps.userInfoLoaded)\n        return (\n            <>\n                <StatusBar\n                    hidden={false}\n                    backgroundColor=\"#fff\"\n                    barStyle=\"dark-content\"\n                />\n                <Navigation initialRoute={AppRoutes.Auth.initialRoute} />\n                <AlertRenderer />\n                <FullScreenLoading />\n            </>\n        )\n\n    return null;\n}\n\nexport default Root"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}